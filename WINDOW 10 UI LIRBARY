--[[
    WINDOWS 10 UI LIBRARY (Standalone)
    101% Accurate Replica | UWP Design Language | SourceSans
]]

local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")
local CoreGui = game:GetService("CoreGui")
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")

local Player = Players.LocalPlayer
local Mouse = Player:GetMouse()

-- // LIBRARY MODULE //
local Library = {}
Library.Flags = {}
Library.Theme = {
    Accent = Color3.fromRGB(0, 120, 215),       -- Default Windows Blue
    Background = Color3.fromRGB(32, 32, 32),    -- Main Background
    Sidebar = Color3.fromRGB(43, 43, 43),       -- Sidebar Grey
    ElementBG = Color3.fromRGB(58, 58, 58),     -- Input/Button Background
    Border = Color3.fromRGB(100, 100, 100),     -- 1px Borders
    Text = Color3.fromRGB(255, 255, 255),       -- Main Text
    SubText = Color3.fromRGB(170, 170, 170),    -- Description/Placeholder
    Hover = Color3.fromRGB(65, 65, 65)          -- Hover Highlight
}

-- Utility: Tween
local function Tween(obj, props, time)
    TweenService:Create(obj, TweenInfo.new(time or 0.2, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), props):Play()
end

-- Utility: Draggable
local function MakeDraggable(TopBar, MainFrame)
    local Dragging, DragInput, DragStart, StartPos
    TopBar.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            Dragging = true; DragStart = input.Position; StartPos = MainFrame.Position
        end
    end)
    TopBar.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement then DragInput = input end
    end)
    UserInputService.InputChanged:Connect(function(input)
        if input == DragInput and Dragging then
            local Delta = input.Position - DragStart
            MainFrame.Position = UDim2.new(StartPos.X.Scale, StartPos.X.Offset + Delta.X, StartPos.Y.Scale, StartPos.Y.Offset + Delta.Y)
        end
    end)
    UserInputService.InputEnded:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then Dragging = false end
    end)
end

function Library:Window(Config)
    local TitleText = Config.Title or "Windows Settings"
    
    -- Main ScreenGui
    local ScreenGui = Instance.new("ScreenGui")
    ScreenGui.Name = "Windows10_UI_" .. math.random(1000,9999)
    ScreenGui.IgnoreGuiInset = true
    ScreenGui.ResetOnSpawn = false
    
    -- Parent to CoreGui if possible, else PlayerGui
    pcall(function() ScreenGui.Parent = CoreGui end)
    if not ScreenGui.Parent then ScreenGui.Parent = Player:WaitForChild("PlayerGui") end

    -- Main Window Frame
    local Main = Instance.new("Frame", ScreenGui)
    Main.Name = "Main"
    Main.Size = UDim2.new(0, 700, 0, 450)
    Main.Position = UDim2.new(0.5, -350, 0.5, -225)
    Main.BackgroundColor3 = Library.Theme.Background
    Main.BorderSizePixel = 1
    Main.BorderColor3 = Color3.fromRGB(0,0,0)

    -- Top Bar
    local TopBar = Instance.new("Frame", Main)
    TopBar.Size = UDim2.new(1, 0, 0, 32)
    TopBar.BackgroundColor3 = Library.Theme.Background
    TopBar.BorderSizePixel = 0
    MakeDraggable(TopBar, Main)

    local TitleLabel = Instance.new("TextLabel", TopBar)
    TitleLabel.Size = UDim2.new(1, -150, 1, 0)
    TitleLabel.Position = UDim2.new(0, 12, 0, 0)
    TitleLabel.BackgroundTransparency = 1
    TitleLabel.Text = TitleText
    TitleLabel.Font = Enum.Font.SourceSans
    TitleLabel.TextSize = 13
    TitleLabel.TextColor3 = Library.Theme.Text
    TitleLabel.TextXAlignment = Enum.TextXAlignment.Left

    -- Window Controls (Minimize, Close)
    local CloseBtn = Instance.new("TextButton", TopBar)
    CloseBtn.Size = UDim2.new(0, 46, 1, 0)
    CloseBtn.Position = UDim2.new(1, -46, 0, 0)
    CloseBtn.BackgroundTransparency = 1
    CloseBtn.Text = "âœ•"
    CloseBtn.Font = Enum.Font.SourceSans
    CloseBtn.TextSize = 14
    CloseBtn.TextColor3 = Library.Theme.Text
    
    CloseBtn.MouseEnter:Connect(function() Tween(CloseBtn, {BackgroundColor3 = Color3.fromRGB(232, 17, 35)}) end)
    CloseBtn.MouseLeave:Connect(function() Tween(CloseBtn, {BackgroundColor3 = Library.Theme.Background}) end)
    CloseBtn.MouseButton1Click:Connect(function() ScreenGui:Destroy() end)

    -- Sidebar (Navigation)
    local Sidebar = Instance.new("Frame", Main)
    Sidebar.Size = UDim2.new(0, 220, 1, -32)
    Sidebar.Position = UDim2.new(0, 0, 0, 32)
    Sidebar.BackgroundColor3 = Library.Theme.Sidebar
    Sidebar.BorderSizePixel = 0

    local SidebarLayout = Instance.new("UIListLayout", Sidebar)
    SidebarLayout.SortOrder = Enum.SortOrder.LayoutOrder
    SidebarLayout.Padding = UDim.new(0, 0)
    
    -- Sidebar Search (Visual)
    local SearchFrame = Instance.new("Frame", Sidebar)
    SearchFrame.Size = UDim2.new(1, 0, 0, 40)
    SearchFrame.BackgroundTransparency = 1
    SearchFrame.LayoutOrder = -1
    
    local SearchBox = Instance.new("TextBox", SearchFrame)
    SearchBox.Size = UDim2.new(0.9, 0, 0, 28)
    SearchBox.Position = UDim2.new(0.05, 0, 0.5, -14)
    SearchBox.BackgroundColor3 = Library.Theme.Background
    SearchBox.BorderColor3 = Library.Theme.Border
    SearchBox.PlaceholderText = "Find a setting"
    SearchBox.PlaceholderColor3 = Library.Theme.SubText
    SearchBox.Text = ""
    SearchBox.TextColor3 = Library.Theme.Text
    SearchBox.Font = Enum.Font.SourceSans
    SearchBox.TextSize = 14

    -- Content Area
    local Content = Instance.new("Frame", Main)
    Content.Size = UDim2.new(1, -220, 1, -32)
    Content.Position = UDim2.new(0, 220, 0, 32)
    Content.BackgroundColor3 = Library.Theme.Background
    Content.BorderSizePixel = 0
    
    -- // TABS //
    local Tabs = {}
    local First = true
    
    local WindowFuncs = {}

    function WindowFuncs:Tab(Name)
        -- 1. Sidebar Button
        local TabBtn = Instance.new("TextButton", Sidebar)
        TabBtn.Size = UDim2.new(1, 0, 0, 42)
        TabBtn.BackgroundTransparency = 1
        TabBtn.Text = ""
        TabBtn.AutoButtonColor = false
        
        local SelectionIndicator = Instance.new("Frame", TabBtn)
        SelectionIndicator.Size = UDim2.new(0, 3, 0, 24)
        SelectionIndicator.Position = UDim2.new(0, 0, 0.5, -12)
        SelectionIndicator.BackgroundColor3 = Library.Theme.Accent
        SelectionIndicator.BorderSizePixel = 0
        SelectionIndicator.Visible = false
        
        local TabLabel = Instance.new("TextLabel", TabBtn)
        TabLabel.Text = Name
        TabLabel.Size = UDim2.new(1, -20, 1, 0)
        TabLabel.Position = UDim2.new(0, 15, 0, 0)
        TabLabel.Font = Enum.Font.SourceSans
        TabLabel.TextSize = 15
        TabLabel.TextColor3 = Library.Theme.Text
        TabLabel.TextXAlignment = Enum.TextXAlignment.Left
        TabLabel.BackgroundTransparency = 1

        -- 2. Page Frame
        local Page = Instance.new("ScrollingFrame", Content)
        Page.Size = UDim2.new(1, 0, 1, 0)
        Page.BackgroundTransparency = 1
        Page.Visible = false
        Page.ScrollBarThickness = 4
        Page.ScrollBarImageColor3 = Library.Theme.SubText
        Page.BorderSizePixel = 0
        
        local PagePadding = Instance.new("UIPadding", Page)
        PagePadding.PaddingLeft = UDim.new(0, 24)
        PagePadding.PaddingTop = UDim.new(0, 24)
        PagePadding.PaddingRight = UDim.new(0, 24)
        
        local PageList = Instance.new("UIListLayout", Page)
        PageList.Padding = UDim.new(0, 12)
        PageList.SortOrder = Enum.SortOrder.LayoutOrder
        
        PageList:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
            Page.CanvasSize = UDim2.new(0, 0, 0, PageList.AbsoluteContentSize.Y + 40)
        end)
        
        -- Header
        local Header = Instance.new("TextLabel", Page)
        Header.Text = Name
        Header.Size = UDim2.new(1, 0, 0, 40)
        Header.Font = Enum.Font.SourceSansLight
        Header.TextSize = 28
        Header.TextColor3 = Library.Theme.Text
        Header.TextXAlignment = Enum.TextXAlignment.Left
        Header.BackgroundTransparency = 1
        Header.LayoutOrder = -1

        local function Activate()
            for _, t in pairs(Tabs) do
                t.Page.Visible = false
                t.Sel.Visible = false
                Tween(t.Btn, {BackgroundTransparency = 1})
            end
            Page.Visible = true
            SelectionIndicator.Visible = true
            Tween(TabBtn, {BackgroundTransparency = 0.95, BackgroundColor3 = Library.Theme.Hover})
        end

        TabBtn.MouseButton1Click:Connect(Activate)
        
        TabBtn.MouseEnter:Connect(function()
            if not Page.Visible then Tween(TabBtn, {BackgroundTransparency = 0.95, BackgroundColor3 = Library.Theme.Hover}) end
        end)
        TabBtn.MouseLeave:Connect(function()
            if not Page.Visible then Tween(TabBtn, {BackgroundTransparency = 1}) end
        end)

        if First then Activate(); First = false end
        table.insert(Tabs, {Btn = TabBtn, Page = Page, Sel = SelectionIndicator})

        -- // ELEMENTS //
        local TabFuncs = {}

        function TabFuncs:Section(Text)
            local S = Instance.new("TextLabel", Page)
            S.Text = Text
            S.Size = UDim2.new(1, 0, 0, 30)
            S.Font = Enum.Font.SourceSansSemibold
            S.TextSize = 15
            S.TextColor3 = Library.Theme.Text
            S.TextXAlignment = Enum.TextXAlignment.Left
            S.TextYAlignment = Enum.TextYAlignment.Bottom
            S.BackgroundTransparency = 1
        end

        function TabFuncs:Button(Text, Callback)
            local BtnContainer = Instance.new("Frame", Page)
            BtnContainer.Size = UDim2.new(1, 0, 0, 32)
            BtnContainer.BackgroundTransparency = 1
            
            local Btn = Instance.new("TextButton", BtnContainer)
            Btn.Size = UDim2.new(0, 200, 1, 0) -- Windows 10 Buttons aren't usually full width
            Btn.BackgroundColor3 = Library.Theme.ElementBG
            Btn.BorderColor3 = Library.Theme.Border
            Btn.Text = Text
            Btn.TextColor3 = Library.Theme.Text
            Btn.Font = Enum.Font.SourceSans
            Btn.TextSize = 15
            
            Btn.MouseButton1Click:Connect(function()
                Tween(Btn, {BackgroundColor3 = Library.Theme.Hover}, 0.1)
                task.wait(0.1)
                Tween(Btn, {BackgroundColor3 = Library.Theme.ElementBG}, 0.1)
                pcall(Callback)
            end)
        end

        function TabFuncs:Toggle(Text, Flag, Default, Callback)
            Library.Flags[Flag] = Default or false
            
            local Container = Instance.new("TextButton", Page)
            Container.Size = UDim2.new(1, 0, 0, 40)
            Container.BackgroundTransparency = 1
            Container.Text = ""
            Container.AutoButtonColor = false
            
            local Label = Instance.new("TextLabel", Container)
            Label.Text = Text
            Label.Size = UDim2.new(1, -60, 1, 0)
            Label.Font = Enum.Font.SourceSans
            Label.TextSize = 15
            Label.TextColor3 = Library.Theme.Text
            Label.TextXAlignment = Enum.TextXAlignment.Left
            Label.BackgroundTransparency = 1
            
            local ToggleFrame = Instance.new("Frame", Container)
            ToggleFrame.Size = UDim2.new(0, 44, 0, 20)
            ToggleFrame.Position = UDim2.new(0, 0, 0.5, 0)
            ToggleFrame.AnchorPoint = Vector2.new(0, 0.5) -- Align left (standard UWP)
            ToggleFrame.BackgroundColor3 = Library.Theme.Background
            
            local Stroke = Instance.new("UIStroke", ToggleFrame)
            Stroke.Color = Library.Theme.SubText
            Stroke.Thickness = 2
            
            Instance.new("UICorner", ToggleFrame).CornerRadius = UDim.new(1, 0)
            
            local Knob = Instance.new("Frame", ToggleFrame)
            Knob.Size = UDim2.new(0, 10, 0, 10)
            Knob.BackgroundColor3 = Library.Theme.SubText
            Instance.new("UICorner", Knob).CornerRadius = UDim.new(1, 0)
            
            local function Update()
                local s = Library.Flags[Flag]
                if s then
                    Tween(ToggleFrame, {BackgroundColor3 = Library.Theme.Accent})
                    Tween(Knob, {Position = UDim2.new(1, -15, 0.5, -5), BackgroundColor3 = Color3.new(1,1,1)})
                    Stroke.Color = Library.Theme.Accent
                else
                    Tween(ToggleFrame, {BackgroundColor3 = Library.Theme.Background})
                    Tween(Knob, {Position = UDim2.new(0, 5, 0.5, -5), BackgroundColor3 = Library.Theme.SubText})
                    Stroke.Color = Library.Theme.SubText
                end
                if Callback then Callback(s) end
            end
            
            Container.MouseButton1Click:Connect(function()
                Library.Flags[Flag] = not Library.Flags[Flag]
                Update()
            end)
            Update()
        end

        function TabFuncs:Slider(Text, Flag, Min, Max, Default, Callback)
            Library.Flags[Flag] = Default or Min
            
            local Container = Instance.new("Frame", Page)
            Container.Size = UDim2.new(1, 0, 0, 50)
            Container.BackgroundTransparency = 1
            
            local Label = Instance.new("TextLabel", Container)
            Label.Text = Text
            Label.Size = UDim2.new(1, 0, 0, 20)
            Label.Font = Enum.Font.SourceSans
            Label.TextSize = 15
            Label.TextColor3 = Library.Theme.Text
            Label.TextXAlignment = Enum.TextXAlignment.Left
            Label.BackgroundTransparency = 1
            
            local ValueLabel = Instance.new("TextLabel", Container)
            ValueLabel.Text = tostring(Default)
            ValueLabel.Size = UDim2.new(0, 50, 0, 20)
            ValueLabel.Position = UDim2.new(1, -50, 0, 0)
            ValueLabel.TextColor3 = Library.Theme.Accent
            ValueLabel.Font = Enum.Font.SourceSans
            ValueLabel.BackgroundTransparency = 1
            
            local SliderLine = Instance.new("Frame", Container)
            SliderLine.Size = UDim2.new(1, 0, 0, 2)
            SliderLine.Position = UDim2.new(0, 0, 0, 35)
            SliderLine.BackgroundColor3 = Library.Theme.SubText
            
            local Fill = Instance.new("Frame", SliderLine)
            Fill.Size = UDim2.new((Default-Min)/(Max-Min), 0, 1, 0)
            Fill.BackgroundColor3 = Library.Theme.Accent
            
            local Knob = Instance.new("Frame", SliderLine)
            Knob.Size = UDim2.new(0, 6, 0, 16)
            Knob.AnchorPoint = Vector2.new(0.5, 0.5)
            Knob.Position = UDim2.new((Default-Min)/(Max-Min), 0, 0.5, 0)
            Knob.BackgroundColor3 = Library.Theme.Accent
            Instance.new("UICorner", Knob).CornerRadius = UDim.new(0, 3)
            
            local Trigger = Instance.new("TextButton", Container)
            Trigger.Size = UDim2.new(1, 0, 0, 20)
            Trigger.Position = UDim2.new(0, 0, 0, 25)
            Trigger.BackgroundTransparency = 1
            Trigger.Text = ""
            
            local Dragging = false
            
            local function Move(input)
                local pos = math.clamp((input.Position.X - SliderLine.AbsolutePosition.X) / SliderLine.AbsoluteSize.X, 0, 1)
                local val = math.floor(Min + ((Max - Min) * pos))
                
                Library.Flags[Flag] = val
                ValueLabel.Text = tostring(val)
                Fill.Size = UDim2.new(pos, 0, 1, 0)
                Knob.Position = UDim2.new(pos, 0, 0.5, 0)
                if Callback then Callback(val) end
            end
            
            Trigger.InputBegan:Connect(function(input)
                if input.UserInputType == Enum.UserInputType.MouseButton1 then
                    Dragging = true; Tween(Knob, {BackgroundColor3 = Color3.new(1,1,1)})
                    Move(input)
                end
            end)
            UserInputService.InputEnded:Connect(function(input)
                if input.UserInputType == Enum.UserInputType.MouseButton1 then
                    Dragging = false; Tween(Knob, {BackgroundColor3 = Library.Theme.Accent})
                end
            end)
            UserInputService.InputChanged:Connect(function(input)
                if Dragging and input.UserInputType == Enum.UserInputType.MouseMovement then Move(input) end
            end)
        end
        
        function TabFuncs:Input(Text, Flag, Placeholder, Callback)
            local Container = Instance.new("Frame", Page)
            Container.Size = UDim2.new(1, 0, 0, 60)
            Container.BackgroundTransparency = 1
            
            local Label = Instance.new("TextLabel", Container)
            Label.Text = Text
            Label.Size = UDim2.new(1, 0, 0, 20)
            Label.Font = Enum.Font.SourceSans
            Label.TextSize = 15
            Label.TextColor3 = Library.Theme.Text
            Label.TextXAlignment = Enum.TextXAlignment.Left
            Label.BackgroundTransparency = 1
            
            local Box = Instance.new("TextBox", Container)
            Box.Size = UDim2.new(0, 250, 0, 32)
            Box.Position = UDim2.new(0, 0, 0, 25)
            Box.BackgroundColor3 = Library.Theme.Background
            Box.BorderColor3 = Library.Theme.Border
            Box.TextColor3 = Library.Theme.Text
            Box.Font = Enum.Font.SourceSans
            Box.TextSize = 14
            Box.PlaceholderText = Placeholder
            Box.PlaceholderColor3 = Library.Theme.SubText
            Box.TextXAlignment = Enum.TextXAlignment.Left
            
            local Underline = Instance.new("Frame", Box)
            Underline.Size = UDim2.new(1, 0, 0, 2)
            Underline.Position = UDim2.new(0, 0, 1, 0)
            Underline.BackgroundColor3 = Library.Theme.Border
            Underline.BorderSizePixel = 0
            
            Box.Focused:Connect(function() Tween(Underline, {BackgroundColor3 = Library.Theme.Accent}) end)
            Box.FocusLost:Connect(function(Enter)
                Tween(Underline, {BackgroundColor3 = Library.Theme.Border})
                if Enter then
                    Library.Flags[Flag] = Box.Text
                    if Callback then Callback(Box.Text) end
                end
            end)
        end

        return TabFuncs
    end
    return WindowFuncs
end

-- // ================================================= //
-- //           STANDALONE USAGE EXAMPLE                //
-- // ================================================= //

-- 1. Create Window
local Window = Library:Window({Title = "Settings"})

-- 2. Settings Tab (Replicating m0dzn)
local SettingsTab = Window:Tab("Settings")

SettingsTab:Section("System")
SettingsTab:Button("Unload Library", function()
    -- Safely remove the UI
    for _, v in pairs(game.CoreGui:GetChildren()) do
        if v.Name:match("Windows10_UI") then v:Destroy() end
    end
end)

SettingsTab:Toggle("Light Mode", "ThemeSwitch", false, function(Val)
    print("Theme Changed:", Val)
end)

SettingsTab:Slider("Menu Scale", "MenuScale", 50, 150, 100, function(Val)
    print("Scale:", Val)
end)

-- 3. Config Tab (Replicating m0dzn)
local ConfigTab = Window:Tab("Configuration")

ConfigTab:Section("Profiles")
ConfigTab:Input("Profile Name", "ConfigName", "Enter name...", function(Text)
    print("Profile Name:", Text)
end)

ConfigTab:Button("Save Configuration", function()
    local name = Library.Flags["ConfigName"] or "Default"
    print("Saving config: " .. name)
end)

ConfigTab:Button("Load Configuration", function()
    local name = Library.Flags["ConfigName"] or "Default"
    print("Loading config: " .. name)
end)
